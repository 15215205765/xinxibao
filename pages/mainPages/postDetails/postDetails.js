(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mainPages/postDetails/postDetails"],{"400f":function(t,e,o){"use strict";var n,i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.redShow=!0},t.e1=function(e){t.plShow=!0},t.e2=function(e){t.redShow=!0})},a=[];o.d(e,"b",function(){return i}),o.d(e,"c",function(){return a}),o.d(e,"a",function(){return n})},8154:function(t,e,o){"use strict";(function(t){o("f466");n(o("66fd"));var e=n(o("851a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},"851a":function(t,e,o){"use strict";o.r(e);var n=o("400f"),i=o("edf0");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("958f");var c,s=o("f0c5"),d=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"7a854150",null,!1,n["a"],c);e["default"]=d.exports},"958f":function(t,e,o){"use strict";var n=o("a94b"),i=o.n(n);i.a},a94b:function(t,e,o){},edf0:function(t,e,o){"use strict";o.r(e);var n=o("f10e"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a},f10e:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(o("3099"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return d(t)||s(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function d(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}var r=function(){return o.e("components/template/PopManager").then(o.bind(null,"b696"))},l={components:{PopManager:r},data:function(){return{imgList:[],phoneHight:0,detailinfo:{},commentPage:1,page_index:2,commentList:[],commentText:"查看更多评论",total:0,recordsPage:1,receivingRecords:{},userShopList:[],hfShow:!1,hfType:"center",hfText:"",cid:null,amid:null,items:[],name:"",plShow:!1,PlText:"",redShow:!1,shareShow:!1,shareType:"top",getRedShow:!1,getRedMoney:null,shareinfo:{},videoShow:!0,lat:null,lng:null,RedStatus:"Ycheck",shopFold:!0,shopFoldIndex:-1,shopTotal:null,isComment:!1,textTip_color:[{color:"#2196F3",border:"0.5px solid #2196F3"},{color:"#25DC4C",border:"0.5px solid #25DC4C"},{color:"#F58F57",border:"0.5px solid #F58F57"},{color:"#A59DD1",border:"0.5px solid #A59DD1"},{color:"#DBB065",border:"0.5px solid #DBB065"}]}},created:function(){},onLoad:function(e){var o=this;t.getStorage({key:"location",success:function(t){o.lat=t.data.latitude,o.lng=t.data.longitude}}),t.getSystemInfo({success:function(t){o.phoneHight=t.windowHeight+"px"}}),o.id=e.id,o.init(e.id)},onReady:function(){},methods:{yl:function(e,o){t.previewImage({current:o[e],urls:o})},navgateTo:function(t){n.default.navigationTo({url:"pages/mainPages/store/index?sid="+t})},loadRed:function(){var t=this;if(t.recordsPage==t.redTotla);else{t.recordsPage++;var e={id:t.id,page:t.recordsPage,page_index:5};n.default._post_form("&p=pocket&do=receivingRecords",e,function(e){t.receivingRecords.list=[].concat(a(t.receivingRecords.list),a(e.data.list)),t.redTotla=e.data.total})}},init:function(e){var o=this,i=n.default.getClientType();o.getShareInfo(),o.getCommentList(e),o.getReceivingRecords(e);var a=t.getStorageSync("curLoction"),c=t.getStorageSync("agencyData");"1"===i||"3"===i?a?c?o.getDetailinfo(e,a):n.default.getAreaId(a,"","",function(t){console.log(t,"post1"),o.getDetailinfo(e,a)}):c?o.getDetailinfo(e,o.currentLoction):n.default.getLocation().then(function(i){n.default.getAreaId(i,"","",function(t){o.$nextTick(function(){o.getDetailinfo(e,i)})}),o.setData({currentLoction:i}),t.setStorageSync("curLoction",i)}):o.getDetailinfo(e)},wxApiCallback:function(e){var o=this;jWeixin.ready(function(){jWeixin.getLocation({type:"gcj02",success:function(i){n.default.getAreaId(i,"","",function(t){o.$nextTick(function(){o.getDetailinfo(e,i)})}),o.setData({currentLoction:i}),t.setStorageSync("curLoction",i)},fail:function(){n.default.getAreaId("","","",function(t){o.$nextTick(function(){o.getDetailinfo(e,"")})})},cancel:function(){n.default.getAreaId("","","",function(t){o.$nextTick(function(){o.getDetailinfo(e,"")})})}})})},getShareInfo:function(){var t=this,e={pageinfo:"pages/mainPages/postDetails/postDetails?id="+t.id};n.default._post_form("&do=Shareinfo",e,function(e){t.shareinfo=e.data})},goStore:function(){var t=this;wxApi.WxopenLocation(t.detailinfo.location.lat,t.detailinfo.location.lng,"",t.detailinfo.address)},goStoreIndex:function(t){n.default.navigationTo({url:"pages/mainPages/store/index?sid="+t})},goHomePage:function(t){var e=this;e.detailinfo.mid>0&&n.default.navigationTo({url:"pages/subPages/homepage/homepage/homepage?mid="+e.detailinfo.mid+"&checkType="+t})},goChat:function(){var t=this;t.detailinfo.mid>0&&n.default.navigationTo({url:"pages/subPages/homepage/chat/chat?other_party_id="+t.detailinfo.mid+"&other_party_type=1&type=1&id="})},share:function(){var e=this,o=location.hash,i=(o.split("?")[0],location.href),a=t.getStorageSync("userinfo"),c=-1===i.indexOf("?")?i+"?head_id="+a.mid:i+"&head_id="+a.mid;console.info("share"),c=encodeURIComponent(c),wxApi.wxRegister(function(){wxApi.wxShare({title:e.shareinfo.title||"",desc:e.shareinfo.desc||"",link:"".concat(n.default.siteInfo.siteroot,"/app/index.php?i=").concat(n.default.siteInfo.uniacid,"&c=entry&m=weliam_smartcity&do=returnRequest&link=").concat(c,"&head_id=").concat(a.mid)||"",imgUrl:e.shareinfo.img||"",success:function(){console.info("share1");var o={id:e.id};n.default._post_form("&p=pocket&do=shareNum",o,function(o){e.getDetailinfo(),t.showToast({icon:"none",title:"分享成功",duration:2e3})})},cancel:function(){}})})},shangjiaFold:function(t){this.shopFold=!1,this.shopFoldIndex=t},shangjiaUpFold:function(t){this.shopFold=!0,this.shopFoldIndex=t},collection:function(){var e=this,o={id:e.id};n.default._post_form("&p=pocket&do=collection",o,function(o){e.detailinfo.is_collection>0?(e.detailinfo.is_collection=0,t.showToast({icon:"none",title:"取消收藏成功",duration:2e3})):(e.detailinfo.is_collection=1,t.showToast({icon:"none",title:"收藏成功",duration:2e3}))})},closeGetRed:function(){var t=this;t.getRedShow=!1},goHome:function(){n.default.navigationTo({url:"pages/mainPages/pocketIInformant/pocketIInformant"})},fabulous:function(){var e=this,o={id:e.id};n.default._post_form("&p=pocket&do=fabulous",o,function(o){if(console.info("detailinfo",e.detailinfo),"1"==e.detailinfo.is_fabulous){e.detailinfo.is_fabulous=0;for(var n=0;n<e.detailinfo.likeids.length;n++)e.detailinfo.likeids[n]==t.getStorageSync("userinfo").avatar&&e.detailinfo.likeids.splice(n,1);e.detailinfo.fabulous_num=Number(e.detailinfo.fabulous_num)-1,t.showToast({icon:"none",title:"取消点赞",duration:2e3})}else e.detailinfo.is_fabulous=1,e.detailinfo.likeids.push(t.getStorageSync("userinfo").avatar),e.detailinfo.fabulous_num=Number(e.detailinfo.fabulous_num)+1,t.showToast({icon:"none",title:"点赞成功",duration:2e3})})},closeShareShow:function(){var t=this;t.shareShow=!1},getRedDetail:function(){var t=this;t.RedStatus="Ncheck";var e={id:t.id};n.default._post_form("&p=pocket&do=redDetail",e,function(e){t.redShow=!1,t.getReceivingRecords(),t.getDetailinfo(),t.getRedMoney=e.data.money,t.getRedShow=!0,t.RedStatus="Ycheck"})},closeRed:function(){var t=this;t.redShow=!1},closePlShow:function(){var t=this;t.plShow=!1},kfPhone:function(){var e=this;t.showModal({title:"联系客户",content:e.detailinfo.phone,success:function(o){o.confirm?t.makePhoneCall({phoneNumber:e.detailinfo.phone}):o.cancel}})},comment:function(){var t=this,e={id:t.id,text:t.PlText};t.isComment||(t.isComment=!0,n.default._post_form("&p=pocket&do=comment",e,function(e){t.plShow=!1,n.default.showSuccess("评论成功",function(){t.isComment=!1}),t.commentPage=1,t.PlText="";var o={id:t.id,page:t.commentPage,page_index:t.page_index,hfText:""};n.default._post_form("&p=pocket&do=commentList",o,function(e){t.commentList=e.data.list,t.total=e.data.total,(t.commentPage==e.data.total||e.data.list.length<2)&&(t.commentText="已无更多数据")})}))},getDetailinfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=this,i={id:o.id||t,lat:e?e.latitude:"",lng:e?e.longitude:""};n.default._post_form("&p=pocket&do=detail",i,function(t){o.detailinfo=t.data,o.getUserShopList(t.data.mid,e)},function(t){"掌上信息已关闭"==t.message&&n.default.navigationTo({url:"pages/mainPages/index/index"})})},getUserShopList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=this,i={mid:t,lat:e?e.latitude:"",lng:e?e.longitude:""};n.default._post_form("&p=store&do=userShopList",i,function(t){for(var e=0;e<t.data.length;e++){var n=[];for(var i in t.data[e].goods){var a=t.data[e].goods[i];""!==a&&("active"==i?(a.css="qiang",a.tag="抢"):"coupon"==i?(a.css="hui",a.tag="券"):"fightgroup"==i?(a.css="pin",a.tag="拼"):"groupon"==i?(a.css="tuan",a.tag="团"):"halfcard"==i?(a.css="ka",a.tag="卡"):"packages"==i&&(a.css="li",a.tag="礼"),n.push(a))}t.data[e].goods=n}o.userShopList=t.data.slice(0,2)})},getCommentList:function(t,e,o){var i=this,c={id:i.id||t,page:i.commentPage,page_index:i.page_index};n.default._post_form("&p=pocket&do=commentList",c,function(t){i.commentList=[].concat(a(i.commentList),a(t.data.list)),i.total=t.data.total,(i.commentPage==t.data.total||t.data.list.length<2)&&(i.commentText="已无更多数据")})},getMoreComment:function(){var t=this;if(t.commentPage==t.total)t.commentText="已无更多数据";else if(2==t.page_index){t.page_index=10;var e={id:t.id,page:t.commentPage,page_index:t.page_index};n.default._post_form("&p=pocket&do=commentList",e,function(e){t.commentList=e.data.list,t.total=e.data.total,t.commentPage==e.data.total&&(t.commentText="已无更多数据")})}else t.commentPage++,t.page_index=10,t.getCommentList()},getReceivingRecords:function(t){var e=this,o={id:e.id||t,page:e.recordsPage,page_index:5};n.default._post_form("&p=pocket&do=receivingRecords",o,function(t){e.receivingRecords=t.data,e.redTotla=t.data.total})},closeHfShow:function(){var t=this;t.hfShow=!1},reply:function(){var e=this,o={id:e.id,cid:e.cid,amid:e.amid,text:e.hfText};e.isComment||(e.isComment=!0,n.default._post_form("&p=pocket&do=reply",o,function(o){e.hfShow=!1,e.isComment=!1;var n={content:e.hfText,reply_name:t.getStorageSync("userinfo").nickname,name:e.name};console.info(e.items),e.items.push(n),e.hfText=""}))},hfPopShow:function(t,e,o,n){var i=this;i.hfShow=!0,i.cid=t,i.amid=e,i.items=o,i.name=n,console.info(i.items)}},onShareAppMessage:function(e){var o=this;console.info("onShareAppMessage"),console.info("detailinfo",o.detailinfo);var i={id:o.id};return n.default._post_form("&p=pocket&do=shareNum",i,function(e){o.detailinfo.share++,t.showToast({icon:"none",title:"分享成功",duration:2e3})}),{title:o.shareinfo.title||"",path:"pages/mainPages/postDetails/postDetails?id="+o.id,desc:o.shareinfo.desc||"",imageUrl:o.shareinfo.img||""}},computed:{TextSubstitution:function(){return t.getStorageSync("TextSubstitution")}}};e.default=l}).call(this,o("543d")["default"])}},[["8154","common/runtime","common/vendor"]]]);