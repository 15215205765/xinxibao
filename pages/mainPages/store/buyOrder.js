(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mainPages/store/buyOrder"],{"08ee":function(o,n,e){"use strict";(function(o){e("f466");i(e("66fd"));var n=i(e("d9b9"));function i(o){return o&&o.__esModule?o:{default:o}}o(n.default)}).call(this,e("543d")["createPage"])},"3a02":function(o,n,e){},"9cd7":function(o,n,e){"use strict";var i,t=function(){var o=this,n=o.$createElement,e=(o._self._c,o.__map(o.useInfo.pack,function(n,e){var i=o.packids.indexOf(n.id),t=o.packids.indexOf(n.id),u=o.packids.indexOf(n.id);return{$orig:o.__get_orig(n),g0:i,g1:t,g2:u}}));o.$mp.data=Object.assign({},{$root:{l0:e}})},u=[];e.d(n,"b",function(){return t}),e.d(n,"c",function(){return u}),e.d(n,"a",function(){return i})},d93e:function(o,n,e){"use strict";e.r(n);var i=e("f3b3"),t=e.n(i);for(var u in i)"default"!==u&&function(o){e.d(n,o,function(){return i[o]})}(u);n["default"]=t.a},d9b9:function(o,n,e){"use strict";e.r(n);var i=e("9cd7"),t=e("d93e");for(var u in t)"default"!==u&&function(o){e.d(n,o,function(){return t[o]})}(u);e("fd2d");var c,a=e("f0c5"),s=Object(a["a"])(t["default"],i["b"],i["c"],!1,null,"12b4ffc0",null,!1,i["a"],c);n["default"]=s.exports},f3b3:function(o,n,e){"use strict";(function(o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(e("3099")),t=u(e("a81a"));function u(o){return o&&o.__esModule?o:{default:o}}function c(o,n,e){return n in o?Object.defineProperty(o,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[n]=e,o}var a=function(){return e.e("components/template/PopManager").then(e.bind(null,"b696"))},s=function(){return e.e("components/template/loadlogo").then(e.bind(null,"9976"))},r=function(){return e.e("components/template/loadlogo").then(e.bind(null,"9976"))},d=function(){return e.e("components/template/follow").then(e.bind(null,"c771"))},l=function(){return e.e("static/mpvue-wxparse/src/wxParse").then(e.bind(null,"65c3"))},f={data:function(){var o;return o={tipsText:"",e:null,followTitleShow:!0,followShow:!1,followType:"payonline",sid:null,iScoupon:!1,buyData:{},loadlogo:!0,vipCouponPrice:"0.00",consumPrice:"",notconsumPrice:"",buyPrice:"0.00",type:""},c(o,"sid",""),c(o,"pack_id",""),c(o,"useInfo",{}),c(o,"shopShow",!1),c(o,"showType","bottom"),c(o,"phoneHight",0),c(o,"sid",""),c(o,"packids",[]),c(o,"payonline",null),c(o,"loading",!0),c(o,"buttonType",1),o},onLoad:function(n){var e=this;o.getSystemInfo({success:function(o){e.phoneHight=o.windowHeight+"px"}}),e.e=n,e.setData({type:n.type||"",mid:n.mid||"",sid:n.sid||""})},components:{loading:s,PopManager:a,loadlogo:r,follow:d,wxParse:l},onShow:function(){var n=this;n.type=n.e.type||"",n.mid=n.mid||"",n.sid=n.sid||"",n.pack_id=n.e.pack_id||"";n.type,n.mid,n.sid,n.pack_id;console.info("e",n.e),n.type?("1"==n.type&&(n.getUseInfo(n.type,n.mid,n.sid,"",function(){console.info(n.useInfo),"1"==n.useInfo.is_shop&&(n.shopShow=!0)}),o.setNavigationBarTitle({title:"特权使用"})),"2"==n.type&&(n.sid=n.e.sid||"",n.getUseInfo(n.type,n.mid,n.sid,"",function(){}),o.setNavigationBarTitle({title:"在线买单"})),"3"==n.type&&(n.pack_id=n.e.pack_id||"",n.getUseInfo(n.type,n.mid,"",n.pack_id,function(){}),o.setNavigationBarTitle({title:"礼包使用"}))):(n.payonline=1,n.getPayOnlineInfo(n.sid))},watch:{notconsumPrice:{handler:function(){var o=this;o.useInfo.discount=Number(o.useInfo.discount),o.consumPrice=Number(o.consumPrice),o.notconsumPrice=Number(o.notconsumPrice),o.buyPrice=Number(o.buyPrice),o.vipCouponPrice=Number(o.vipCouponPrice),o.buyPrice=t.default.subtractionFloat(o.consumPrice,o.notconsumPrice,100)*(o.useInfo.discount/10)+o.notconsumPrice,0!=o.buyPrice?o.buyPrice=o.buyPrice.toFixed(2):o.buyPrice=o.buyPrice,o.vipCouponPrice=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100),0!=o.vipCouponPrice?o.vipCouponPrice=o.vipCouponPrice.toFixed(2):o.vipCouponPrice=o.vipCouponPrice}},iScoupon:{handler:function(){var o=this;o.notconsumPrice=""}},consumPrice:{handler:function(){var o=this;o.iScoupon?(o.useInfo.discount=Number(o.useInfo.discount),o.consumPrice=Number(o.consumPrice),o.notconsumPrice=Number(o.notconsumPrice),o.buyPrice=Number(o.buyPrice),o.vipCouponPrice=Number(o.vipCouponPrice),t.default.subtractionFloat(o.consumPrice,o.notconsumPrice,100)*(o.useInfo.discount/10)+o.notconsumPrice!=0?o.buyPrice=(t.default.subtractionFloat(o.consumPrice,o.notconsumPrice,100)*(o.useInfo.discount/10)+o.notconsumPrice).toFixed(2):o.buyPrice=t.default.subtractionFloat(o.consumPrice,o.notconsumPrice,100)*(o.useInfo.discount/10)+o.notconsumPrice,0!=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100)?o.vipCouponPrice=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100).toFixed(2):o.vipCouponPrice=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100)):(o.useInfo.discount=Number(o.useInfo.discount),o.consumPrice=Number(o.consumPrice),o.notconsumPrice=Number(o.notconsumPrice),o.buyPrice=Number(o.buyPrice),o.vipCouponPrice=Number(o.vipCouponPrice),o.consumPrice*(o.useInfo.discount/10)!=0?o.buyPrice=(o.consumPrice*(o.useInfo.discount/10)).toFixed(2):o.buyPrice=o.consumPrice*(o.useInfo.discount/10),0!=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100)?o.vipCouponPrice=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100).toFixed(2):o.vipCouponPrice=t.default.subtractionFloat(o.consumPrice,o.buyPrice,100))}}},methods:{closeFollowTitle:function(){var o=this;o.followTitleShow=!1},closeFollowPop:function(){var o=this;o.followShow=!1},openQrShow:function(){var o=this;o.followShow=!0},iScouponCheck:function(){var o=this;o.iScoupon=!o.iScoupon,o.iScoupon||(o.notconsumPrice="")},checkLb:function(o){var n=this;if(-1==n.packids.indexOf(o))n.packids.push(o);else for(var e=0;e<n.packids.length;e++)n.packids[e]==o&&n.packids.splice(e,1)},closeShopShow:function(o){var n=this;n.sid=o,n.pack_id="",n.shopShow=!1,n.getUseInfo(n.type,n.mid,n.sid,n.pack_id,function(){})},getPayOnlineInfo:function(o){var n=this,e={sid:o};i.default._post_form("&p=halfcard&do=getPayOnlineInfo",e,function(o){n.loading=!1,n.useInfo=o.data,n.loadlogo=!1},function(o){n.loadlogo=!1,"非核销员"==o.message&&i.default.navigationTo({url:"pages/mainPages/index/index"})})},usePrivileged:function(){},usePayOnline:function(){var n=this;n.sid,n.consumPrice,n.notconsumPrice;if(n.buttonType=2,"1"==n.payonline){var e={type:n.type,id:n.sid};i.default._post_form("&do=Follow",e,function(o){if("0"==o.data.status){var e={sid:n.sid,money:n.consumPrice,no_money:n.notconsumPrice};i.default._post_form("&p=halfcard&do=usePayOnline",e,function(o){i.default.navigationTo({url:"pages/mainPages/payment/payment?orderid="+o.data+"&plugin=halfcard"})},function(o){n.buttonType=1,"非核销员"==o.message&&i.default.navigationTo({url:"pages/mainPages/index/index"})})}else n.buttonType=1,n.followShow=!0})}else{var t={mid:n.mid,packids:n.packids,money:n.consumPrice,no_money:n.notconsumPrice,card_id:n.useInfo.card_id};n.buttonType=2,i.default._post_form("&p=halfcard&do=usePrivileged",t,function(n){o.showToast({icon:"none",title:"消费成功",duration:2e3,success:function(){setTimeout(function(){i.default.navigationTo({url:"pages/mainPages/index/index"})},2e3)}})},function(o){n.buttonType=1,"非核销员"==o.message&&i.default.navigationTo({url:"pages/mainPages/index/index"})})}},getUseInfo:function(o,n,e,t,u){var c=this,a={type:c.type||o,sid:c.sid||e,pack_id:c.pack_id||t,mid:c.mid||n};i.default._post_form("&p=halfcard&do=useInfo",a,function(o){c.loading=!1,c.useInfo=o.data,c.payonline=o.data.payonline,c.loadlogo=!1,u&&u()},function(o){i.default.navigationTo({url:"pages/mainPages/userCenter/userCenter"})})}},computed:{}};n.default=f}).call(this,e("543d")["default"])},fd2d:function(o,n,e){"use strict";var i=e("3a02"),t=e.n(i);t.a}},[["08ee","common/runtime","common/vendor"]]]);