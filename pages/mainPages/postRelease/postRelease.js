(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mainPages/postRelease/postRelease"],{"1e70":function(t,o,n){"use strict";var e,i=function(){var t=this,o=t.$createElement,n=(t._self._c,t.__map(t.setInfo.label,function(o,n){var e=t.info.keyword.indexOf(o);return{$orig:t.__get_orig(o),g0:e}}));t._isMounted||(t.e0=function(o){t.locatShow=!0},t.e1=function(o){t.locatShow=!1}),t.$mp.data=Object.assign({},{$root:{l0:n}})},a=[];n.d(o,"b",function(){return i}),n.d(o,"c",function(){return a}),n.d(o,"a",function(){return e})},"2d50":function(t,o,n){"use strict";var e=n("4a50"),i=n.n(e);i.a},"4a50":function(t,o,n){},"70de":function(t,o,n){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=a(n("a34a")),i=a(n("3099"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,o,n,e,i,a,s){try{var r=t[a](s),c=r.value}catch(d){return void n(d)}r.done?o(c):Promise.resolve(c).then(e,i)}function r(t){return function(){var o=this,n=arguments;return new Promise(function(e,i){var a=t.apply(o,n);function r(t){s(a,e,i,r,c,"next",t)}function c(t){s(a,e,i,r,c,"throw",t)}r(void 0)})}}function c(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{},e=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.forEach(function(o){d(t,o,n[o])})}return t}function d(t,o,n){return o in t?Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[o]=n,t}var u=function(){return n.e("components/template/PopManager").then(n.bind(null,"b696"))},l=function(){return n.e("components/template/loadlogo").then(n.bind(null,"9976"))},f=function(){return n.e("components/template/PhoneMask").then(n.bind(null,"6173"))},p={components:{PopManager:u,Loadlogo:l,PhoneMask:f},data:function(){return{show1:!1,HideDisabled:!1,releaseType:1,phoneHeight:null,isOpenLaction:!1,showmain:null,marginT:{marginTop:"20rpx"},info:{content:"",onetype:null,nickname:"",phone:"",share_title:"",type:null,keyword:[],img:[],locastatus:"",address:"",lat:"",lng:"",video_link:"",id:""},dwText:"不显示位置",setInfo:{set:{locastatus:0}},locaStaus:null,show:!1,type:"bottom",res:null,text:null,ysStatus:0,images:[],src:"",locatShow:!1,shi:"00",fen:"00",miao:0,h:0,m:0,s:0,ms:0,time:0,str:"00:00:00",id:null,isAndroid:"",isAdclose:!1}},computed:{isWxaudit:function(){return this.$store.state.isWxAudit}},onShow:function(){var t=this,o={id:t.info.type};i.default._post_form("&p=pocket&do=preparation",o,function(o){t.setInfo=o.data}),t.preparation()},onLoad:function(o){console.log(o,"2222");var n=this;t.getSystemInfo({success:function(t){n.phoneHeight=t.windowHeight+"px",n.isAndroid="android"===t.platform?"1":"2"}}),this.info.onetype=o.onetype,this.info.type=o.type,n.id=o.id,console.info(o.id),n.init(o.id)},mounted:function(){},methods:{closePop1:function(){var t=this;t.show1=!1},changeLoca:function(){var t=this;t.dwText=t.info.address,t.info.locastatus="1",t.locatShow=!1},nochangeLocation:function(){var t=this;t.info.locastatus="0",t.locatShow=!1,t.dwText="不显示位置"},init:function(t){var o=this;t?(o.getEditPocket(t),o.info.id=t,console.info(o.info.id)):(o.info.locastatus=0,o.preparation())},changeLocation:function(){var o=this;t.chooseLocation({success:function(t){o.info.address=t.address,o.info.locastatus="1",o.info.lat=t.latitude,o.info.lng=t.longitude,o.dwText=t.address,o.locatShow=!1}})},closeLocatShow:function(){var t=this;t.locatShow=!1},getEditPocket:function(t){var o=this,n={id:t};i.default._post_form("&p=pocket&do=editPocket",n,function(t){if(o.info=c({},o.info,t.data),o.src=t.data.video_url,console.info(t.data.video_link),o.info.latitude=t.data.location.lat,o.info.longitude=t.data.location.lng,o.info.lat=t.data.location.lat,o.info.lng=t.data.location.lng,t.data.address&&""!=t.data.address?o.dwText=t.data.address:""==t.data.address&&(o.dwText="不显示位置"),t.data.img_url){for(var n=[],e=0;e<t.data.img_url.length;e++)o.images.push(t.data.img_url[e]),n.push(t.data.img_url[e]);o.info.img=n,console.log(o.info.img,"_this.info.img")}var a={id:o.info.type};i.default._post_form("&p=pocket&do=preparation",a,function(t){o.setInfo=t.data})})},release:function(){var t=this,o=this,n=o.info;o.HideDisabled=!0,i.default._post_form("&p=pocket&do=release",n,function(o){if(0==o.data.status)i.default.navigationTo({url:"pages/mainPages/successRelease/successRelease?id="+o.data.id});else{var n=t,e={id:o.data.id,num:"",payfor:1};i.default._post_form("&p=pocket&do=createOrder",e,function(t){console.log(t,"000000"),0==t.errno&&(i.default.navigationTo({url:"pages/mainPages/payment/payment?orderid="+t.data.orderid+"&plugin=pocket&types=1"}),n.HideDisabled=!1)})}},function(o){if("未绑定手机号"==o.data.message){var n=t;n.show1=!0,n.releaseType=1}})},deletVideo:function(){var t=this;t.src="",t.info.video_link="",t.isAdclose=!1,t.marginT.marginTop="20rpx"},uoloadIgs:function(o){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,a=this;wxApi.uoloadIg(e.localIds[n],function(s){if("uploadImage:ok"===s.errMsg){var r={upload_type:2,id:s.serverId};i.default._post_form("&do=uploadFiles",r,function(i){0===i.errno&&(a.images.push(i.data.img),a.info.img.push(i.data.img),n<o-1&&(n++,t.setTimeout(a.uoloadIgs(o,n,e),500)))},!1,function(){})}else i.default.showError("上传失败")})},uploadFiles:function(){var t=this;wx.chooseImage({count:6,sourceType:["album","camera"],success:function(){var o=r(e.default.mark(function o(n){var a,s;return e.default.wrap(function(o){while(1)switch(o.prev=o.next){case 0:a=0;case 1:if(!(a<n.tempFilePaths.length)){o.next=10;break}return o.next=4,i.default._upLoad(n.tempFilePaths[a]);case 4:s=o.sent,t.images.push(s.data.img),t.info.img.push(s.data.img);case 7:a++,o.next=1;break;case 10:case"end":return o.stop()}},o,this)}));function n(t){return o.apply(this,arguments)}return n}()})},upButton:function(){var t=this;t.ChooseVdo()},ChooseVdo:function(){var o=this;t.chooseVideo({count:1,sourceType:["camera","album"],success:function(n){o.info.video_link=n.tempFilePath,console.info(n.tempFilePath);i.default.siteInfo.siteroot,t.showLoading(),t.uploadFile({url:i.default.api_root+"&do=uploadFiles",filePath:n.tempFilePath,name:"file",formData:{upload_type:1,is_base:1},success:function(n){var e=JSON.parse(n.data),a=new o.$util.Base64;console.info("data",e),o.marginT.marginTop="300rpx",0===e.errno?(o.src=a.decode(e.data.img),o.info.video_link=a.decode(e.data.image),o.isAdclose=!0):i.default.showError(e.message,function(){}),t.hideLoading()},fail:function(n){console.info("resInfofail",n),o.showmain=JSON.stringify(n),t.hideLoading()}})}})},resultPath:function(o){t.showModal({content:JSON.stringify(o)})},uploadVideo:function(o){var n=this;t.showLoading(),t.uploadFile({url:i.default.api_root+"&do=uploadFiles",filePath:o,name:"file",formData:{upload_type:1},success:function(o){var e=JSON.parse(o.data);console.info("res",o),n.marginT.marginTop="300rpx",0===e.errno?(n.src=e.data.img,n.info.video_link=e.data.image):i.default.showError(e.message),t.hideLoading()},fail:function(o){t.hideLoading()}})},lyStar:function(){var t=this;t.s++,t.s>=60&&(t.s=0,t.m=t.m+1),t.m>=60&&(t.m=0,t.h=t.h+1),t.str=t.toDub(t.h)+":"+t.toDub(t.m)+":"+t.toDub(t.s)},start:function(){console.info("start");var t=this;t.ysStatus=1,t.timer=setInterval(t.lyStar,1e3)},toDub:function(t){return t<10?"0"+t:""+t},yyStop:function(){console.info("Stop");var t=this;t.ysStatus=0,t.h=0,t.m=0,t.s=0,t.str="00:00:00",clearInterval(t.timer)},preparation:function(){var o=this,n={id:o.info.type},e=i.default.getClientType();i.default._post_form("&p=pocket&do=preparation",n,function(n){o.setInfo=n.data,o.info.nickname=n.data.user.nickname,o.info.phone=n.data.user.mobile,o.locaStaus=Number(n.data.set.locastatus),"2"==n.data.set.locastatus&&(o.info.locastatus=1,"1"===e?wxApi.getLocation({type:"gcj02",success:function(t){o.info.lng=t.longitude,o.info.lat=t.latitude,console.info("info",t.latitude,t.longitude);var n={lat:t.latitude,lng:t.longitude};i.default._post_form("&do=cityLocation",n,function(t){console.info("cityLocation"),o.info.address=t.data.address_component.city,o.dwText=t.data.address_component.city})},fail:function(o){t.showToast({icon:"none",title:"定位失败",duration:2e3})},complete:function(t){console.log(t)}}):"3"===e?wx.getLocation({type:"gcj02",success:function(t){o.info.lng=t.longitude,o.info.lat=t.latitude,console.info("info",t.latitude,t.longitude);var n={lat:t.latitude,lng:t.longitude};i.default._post_form("&do=cityLocation",n,function(t){console.info("cityLocation"),o.info.address=t.data.address_component.city,o.dwText=t.data.address_component.city})},fail:function(o){t.showToast({icon:"none",title:"定位失败",duration:2e3})}}):t.getLocation({type:"gcj02",success:function(t){o.info.lng=t.longitude,o.info.lat=t.latitude;var n={lat:t.latitude,lng:t.longitude};i.default._post_form("&do=cityLocation",n,function(t){console.info("cityLocation"),o.info.address=t.data.address_component.city,o.dwText=t.data.address_component.city})},fail:function(o){t.showToast({icon:"none",title:"定位失败",duration:2e3})}}))})},checkSecondsType:function(t){var o=this;if(-1==o.info.keyword.indexOf(t))o.info.keyword.push(t);else for(var n=0;n<o.info.keyword.length;n++)o.info.keyword[n]==t&&o.info.keyword.splice(n,1);console.info(o.info.keyword)},closePop:function(){var t=this;t.show=!1},deletImg:function(t){for(var o=this,n=0;n<o.images.length;n++)o.images[n]==t&&o.images.splice(n,1);for(var e=0;e<o.info.img.length;e++)o.info.img[e]==t&&o.info.img.splice(e,1)}}};o.default=p}).call(this,n("543d")["default"])},8732:function(t,o,n){"use strict";n.r(o);var e=n("70de"),i=n.n(e);for(var a in e)"default"!==a&&function(t){n.d(o,t,function(){return e[t]})}(a);o["default"]=i.a},a465:function(t,o,n){"use strict";n.r(o);var e=n("1e70"),i=n("8732");for(var a in i)"default"!==a&&function(t){n.d(o,t,function(){return i[t]})}(a);n("2d50");var s,r=n("f0c5"),c=Object(r["a"])(i["default"],e["b"],e["c"],!1,null,"fea1c778",null,!1,e["a"],s);o["default"]=c.exports},f228:function(t,o,n){"use strict";(function(t){n("f466");e(n("66fd"));var o=e(n("a465"));function e(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,n("543d")["createPage"])}},[["f228","common/runtime","common/vendor"]]]);