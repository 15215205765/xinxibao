(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/subPages/submitOrder/submitOrder"],{"570d":function(t,e,a){},"694c":function(t,e,a){"use strict";a.r(e);var r=a("73b4"),u=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,function(){return r[t]})}(s);e["default"]=u.a},"73b4":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=s(a("3099")),u=s(a("a81a"));function s(t){return t&&t.__esModule?t:{default:t}}var n=function(){return a.e("components/template/bindPhone").then(a.bind(null,"58dc"))},i=function(){return a.e("components/template/redPagDown").then(a.bind(null,"d16d"))},o={components:{bindPhone:n,redPagDown:i},data:function(){return{redPackageNumSubtract:{val:"",num:0},redPags:!1,redPackageNum:null,TextSubstitution:{},orderSubmitInfo:{},integralType:0,num:null,allMoney:0,addressid:"",id:"",usestatus:1,allUsestatus:0,buystatus:"",createOrderInfo:{id:null,creditstatus:"",num:null,plugin:1,specid:177,thname:"",thmobile:"",addressid:"",remark:"",buystatus:null},popShow:!1,cardList:[],cardId:null,card_price:null,member_number:0,cut_money:0,redPagList:[],redPagId:0}},onShow:function(t){this.init()},onLoad:function(e){e.group_id?this.group_id=e.group_id:this.group_id="",this.createOrderInfo.id=e.goods_id,this.createOrderInfo.plugin=e.plugin,this.createOrderInfo.specid=e.specid,this.num=e.goods_num,this.createOrderInfo.num=e.goods_num,this.buystatus=e.buystatus,this.createOrderInfo.buystatus=e.buystatus,console.log(typeof e.plugin),this.TextSubstitution=t.getStorageSync("TextSubstitution");var a={goods_id:e.goods_id,plugin:e.plugin,specid:e.specid,goods_num:e.goods_num,buystatus:e.buystatus};t.setStorageSync("orderInfos",a),this.init()},watch:{usestatus:{handler:function(){var t=this;2==t.orderSubmitInfo.usestatus&&1==t.usestatus&&(t.allMoney=u.default.additionFloat(t.allMoney,t.orderSubmitInfo.expressprice,100)),2==t.orderSubmitInfo.usestatus&&0==t.usestatus&&(t.allMoney=u.default.subtractionFloat(t.allMoney,t.orderSubmitInfo.expressprice,100))}},integralType:{handler:function(){var t=this,e=Number(t.orderSubmitInfo.creditdiscount);t.createOrderInfo.creditstatus=t.integralType,0==t.integralType&&""!==t.orderSubmitInfo.creditdiscount&&(t.allMoney=u.default.additionFloat(t.allMoney,e,100)),1==t.integralType&&""!==t.orderSubmitInfo.creditdiscount&&(t.allMoney=u.default.subtractionFloat(t.allMoney,e,100))}}},computed:{TextSubstitution:function(){return t.getStorageSync("TextSubstitution")},actual_pay_price:function(){var t=this,e=t.orderSubmitInfo,a=t.num,r=t.cardId,u=t.integralType,s=t.card_price,n=t.usestatus,i=0,o=(2==e.usestatus&&1==n||1==n)&&e.expressprice?e.expressprice:0,d=e.goodsprice*Number(a);return 1===e.is_openvip&&r&&e.carddiscount>0&&(d-=Number(e.carddiscount)),e.vipdiscount&&e.vipdiscount>0&&(d-=e.vipdiscount),1===u&&(d-=Number(e.creditdiscount)),""!=t.group_id||!t.orderSubmitInfo.is_com_dis&&"1"!=t.orderSubmitInfo.is_com_dis||(d-=Number(t.orderSubmitInfo.com_dis_price)),d-=t.cut_money,i=(d>0?d:0)+o+(r?Number(s):0),Number(i)>0?Number(i).toFixed(2):0}},methods:{prices:function(t){var e=this;console.log(t,"redPacketItem"),t?(e.redPagId=t.id,e.cut_money=t.cut_money,e.redPackageNum="已选1张",e.redPackageNumSubtract.val="-"+t.cut_money,e.redPackageNumSubtract.num=t.cut_money):(e.redPagId=0,e.cut_money=0,e.redPackageNum="可用"+e.orderSubmitInfo.redpacklist.list.length+"张",e.redPackageNumSubtract.val="",e.redPackageNumSubtract.num=0)},redPagClosePop:function(t){var e=this;e.$refs.redPagDown.redPagss=!1},redPagShows:function(){var t=this;t.$refs.redPagDown.redPagss=!0},closePop:function(){var t=this;t.popShow=!1},init:function(){var t=this;t.getOrderSubmitInfo(),t.getcardList()},getcardList:function(){var t=this;r.default._post_form("&p=halfcard&do=cardList",{},function(e){0===e.errno&&t.setData({cardList:e.data.list})})},select_card:function(t){var e=this.cardId;t.id===e?this.setData({cardId:null,card_price:0}):this.setData({cardId:t.id,card_price:t.price})},moreCardList:function(){var t=this,e=t.member_number,a=t.cardList.length;0===e?t.setData({member_number:a}):e===a&&t.setData({member_number:0})},createOrder:function(t){var e=this;if(0==e.orderSubmitInfo.usestatus&&(e.allUsestatus=0),1==e.orderSubmitInfo.usestatus&&(e.allUsestatus=1),2==e.orderSubmitInfo.usestatus&&1==e.usestatus&&(e.allUsestatus=1),2==e.orderSubmitInfo.usestatus&&0==e.usestatus&&(e.allUsestatus=0),void 0==e.orderSubmitInfo.address&&(e.orderSubmitInfo.address={id:""}),0==e.usestatus&&2==e.orderSubmitInfo.usestatus||1==e.usestatus&&0==e.orderSubmitInfo.usestatus){var a=/^1[3|4|5|6|7|8|9][0-9]{9}$/;if(!e.createOrderInfo.thname)return r.default.showError("请填写联系人姓名"),!1;if(!a.test(e.createOrderInfo.thmobile))return r.default.showError("请填写正确的联系电话"),!1}var u={groupid:e.group_id,id:e.createOrderInfo.id,num:e.num,usestatus:e.allUsestatus,plugin:e.orderSubmitInfo.plugin,specid:e.createOrderInfo.specid,creditstatus:e.integralType,thname:e.createOrderInfo.thname,thmobile:e.createOrderInfo.thmobile,addressid:e.orderSubmitInfo.address.id,remark:e.createOrderInfo.remark,buystatus:e.buystatus,vip_card_id:e.cardId,redpackid:e.redPagId};r.default._post_form("&p=pay&do=createOrder",u,function(t){1==t.data.status&&(e.saveForm("0"),r.default.navigationTo({url:"pages/mainPages/payment/payment?orderid="+t.data.orderid+"&plugin="+e.orderSubmitInfo.plugin})),0==t.data.status&&(console.info("plugin",t.data.plugin),r.default.navigationTo({url:"pages/mainPages/paySuccess/paySuccess?tid="+t.data.tid+"&plugin="+t.data.plugin}))},function(t){"未绑定手机号"==t.data.message&&(e.popShow=!0)})},goAddress:function(t){r.default.navigationTo({url:"pages/subPages/receivingAddress/receivingAddress?type="+t})},changIntegral:function(t){var e=this;e.integralType=t},getOrderSubmitInfo:function(){var t=this,e=t.createOrderInfo;r.default._post_form("&p=pay&do=orderSubmit",e,function(e){console.log(e,1022),e.data.redpacklist.list.length?t.redPackageNum="可用"+e.data.redpacklist.list.length+"张":t.redPackageNum=null,t.orderSubmitInfo=e.data,t.createOrderInfo.thmobile=e.data.mobile,t.createOrderInfo.thname=e.data.realname,e.data.goodsprice=Number(e.data.goodsprice),e.data.expressprice=Number(e.data.expressprice),e.data.vipdiscount=Number(e.data.vipdiscount),t.num=Number(t.num);var a=t.orderSubmitInfo.redpacklist.list;if(a.map(function(t){t.isCheked=!1}),t.setData({redPagList:a}),1==e.data.usestatus&&(console.info("第一步"),t.allMone=u.default.additionFloat(u.default.multiplicationFloat(e.data.goodsprice,t.num,100),e.data.expressprice,100),t.createOrderInfo.addressid=e.data.address.id,""!==e.data.halfcardflag&&""!==e.data.vipdiscount&&(t.allMoney=u.default.subtractionFloat(u.default.additionFloat(u.default.multiplicationFloat(e.data.goodsprice,t.num,100),e.data.expressprice,100),e.data.vipdiscount,100))),2==e.data.usestatus&&1==t.usestatus&&(console.info("第二步"),t.allMone=u.default.additionFloat(u.default.multiplicationFloat(e.data.goodsprice,t.num,100),e.data.expressprice,100),""!==e.data.halfcardflag&&""!==e.data.vipdiscount)){var r=u.default.multiplicationFloat(e.data.goodsprice,t.num,100),s=e.data.expressprice,n=u.default.additionFloat(r,s,100);t.allMoney=u.default.subtractionFloat(n,e.data.vipdiscount,100)}(0==e.data.usestatus||2==e.data.usestatus&&0==t.usestatus)&&(console.info("第三步"),t.allMoney=u.default.subtractionFloat(u.default.multiplicationFloat(e.data.goodsprice,t.num,100),e.data.vipdiscount,100))})}}};e.default=o}).call(this,a("543d")["default"])},"8c0b":function(t,e,a){"use strict";(function(t){a("f466");r(a("66fd"));var e=r(a("bc36"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},bc36:function(t,e,a){"use strict";a.r(e);var r=a("c923"),u=a("694c");for(var s in u)"default"!==s&&function(t){a.d(e,t,function(){return u[t]})}(s);a("c6a6");var n,i=a("f0c5"),o=Object(i["a"])(u["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],n);e["default"]=o.exports},c6a6:function(t,e,a){"use strict";var r=a("570d"),u=a.n(r);u.a},c923:function(t,e,a){"use strict";var r,u=function(){var t=this,e=t.$createElement,a=(t._self._c,(t.orderSubmitInfo.goodsprice*t.num).toFixed(2));t._isMounted||(t.e0=function(e){t.usestatus=1},t.e1=function(e){t.usestatus=0},t.e2=function(e){t.usestatus=1},t.e3=function(e){t.usestatus=0}),t.$mp.data=Object.assign({},{$root:{g0:a}})},s=[];a.d(e,"b",function(){return u}),a.d(e,"c",function(){return s}),a.d(e,"a",function(){return r})}},[["8c0b","common/runtime","common/vendor"]]]);